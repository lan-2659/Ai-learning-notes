# yolo11训练模型的三种方式

**只要是用yolo11训练模型，都按照以下步骤：**
    1、准备好环境、数据集
    2、引入预训练模型
    3、写代码

```python
# 从头开始训练
model = YOLO("yolo11n-cls.yaml")

# 使用预训练模型训练，网络结构和预训练模型一致
model = YOLO("yolo11n-cls.pt")

# 使用预训练模型训练，且更改了网络结构（自定义网络结构）
model = YOLO("yolo11n-cls.yaml").load("yolo11n-cls.pt")
```



# yolo11训练鲜花分类模型

```python
# 导入 yolo11 加载模型的 YOLO 类
from ultralytics import YOLO

model = YOLO("yolo11s-cls.pt")

# 开始训练
"""
        train 函数：
            data --- 数据集路径，分类模型不需要配置 yaml 文件
            epochs --- 训练轮次
            batch --- 批处理大小
            save --- 保存结果
            device --- 设备
    """
model.train(
    data="datasets/flowers",
    epochs=100,
    batch=16,
    save=True,
    device="0",
)
```



# 鲜花分类模型进行推理

**分类模型和检测模型的推理结果是不一样的**

```PYTHON
import torch
from ultralytics import YOLO


# 加载训练好的模型
model = YOLO("runs/classify/train/weights/best.pt")

results = model.predict(source="meigui.jpeg", save=True)
"""
predict 预测参数：
	source：检测的资源
    save：保存检测结果
"""

# torch 关闭科学计数法
torch.set_printoptions(sci_mode=False)
# 遍历results结果，处理每一个数据
for result in results:
    print(result)
    """
            boxes 属性：【目标检测的结果：置信度、类别、框的坐标】
                目标检测的结果中，boxes属性的值为 ultralytics.engine.results.Boxes object
                分类的结果中，boxes属性的值为空
            names 属性：
                类型信息，是一个字典，key 是索引
            path 属性：
                资源路径
            probs 属性：【类别、置信度】
                目标检测的结果中，probs属性的值为空
                分类的结果中，probs属性的值为 ultralytics.engine.results.Probs object
            save_dir 属性：
                结果存储的位置
            speed 属性：
                预处理时间、推理时间、后置处理时间，是一个字典
        """

    print(result.probs)
    """
            data 属性：每一个类别的置信度信息【概率值】
            shape 属性：14 个类别
            top1 属性：data中最高置信度的位置【也是类别标签】
            top1conf 属性：概率最高的类别的置信度
    """

    # 获取置信度最高的类别
    print(result.names[result.probs.top1])

```



# yolo11训练火灾目标检测模型

```PYTHON
from ultralytics import YOLO


model = YOLO('yolo11s.pt')  # 加载预训练模型

# 开始训练
model.train(
    data='datasets/fire/fire.yaml',
    epochs=5,
    batch=8,
    workers=8,
    device=0,
    save=True
) 
```



# 火灾目标检测模型推理

```PYTHON
from ultralytics import YOLO

model = YOLO("runs/detect/train/weights/best.pt")  # 加载模型

results = model("datasets/fire/test/10.jpg", save=True)  # 推理

for result in results:
    print(result)
    print(result.boxes)  # 输出检测框信息
```



# 将训练好的模型转为 tensorRT 格式

想要使用 model.export 方法将模型转换为 tensorRT 格式，需要先安装 tensorrt (详情参考同级目录下的 TensorRT加速推理.md 文件)

```PYTHON
from ultralytics import YOLO

# 加载训练好的模型
model = YOLO("runs/detect/train/weights/best.pt")  

"""
导出为 TensorRT 格式
"""
model.export(format="engine", dynamic=True, int8=True, data='datasets/fire/fire.yaml')

```



# 使用 tensorRT 格式的模型进行推理

使用这个格式的模型进行推理时，与使用其它格式的推理方式相同：

- 加载模型
- 调用 predict 方法进行推理

```PYTHON
from ultralytics import YOLO

model = YOLO("runs/detect/train/weights/best.engine")  # 加载模型

results = model.predict("datasets/fire/test/10.jpg", save=True)  # 推理

for result in results:
    print(result)
```

